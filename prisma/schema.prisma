// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

datasource pg {
  provider = "postgres"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

generator prismaDbmlGenerator {
  provider = "prisma-dbml-generator"
}

model User {
  id             String    @id @pg.Char(36) // nanoid
  name           String?   @pg.VarChar(200)
  family         String?   @pg.VarChar(200)
  email          String    @unique(map: "user_email_unique_constraints") @pg.VarChar(320)
  username       String    @unique(map: "user_username_unique_constraints") @pg.VarChar(200)
  hashedPassword String    @map("hashed_password")
  createdAt      DateTime  @default(now()) @map("created_at") @pg.Timestamptz(0)
  updatedAt      DateTime  @updatedAt @map("updated_at") @pg.Timestamptz(0)
  deletedAt      DateTime?

  // Relationships

  @@map("users")
}

// Undone
// https://github.com/prisma/prisma/issues/2789#issuecomment-1014839425
// https://hussainwali.medium.com/insert-spatial-data-into-postgres-postgis-using-typeorm-in-nestjs-nodejs-2e03ab7ff0d

// IMO really useful
// https://github.com/prisma/prisma-examples/tree/latest/typescript/postgis-express
// https://github.com/prisma/prisma/issues/1798#issuecomment-775016807
// https://github.com/prisma/prisma/issues/1798#issuecomment-1023710584
// https://github.com/prisma/prisma/issues/10634#issuecomment-1069112132
// https://github.com/prisma/database-schema-examples/blob/8cea37d834f3effd6aad53e98c5bc865b4d85335/postgres/sakila/schema.sql
// https://github.com/redwoodjs/redwood/issues/4718#issuecomment-1065503274

// https://github.com/prisma/prisma/issues/2788
// https://github.com/prisma/prisma/issues/1798#issuecomment-948082095
// https://github.com/prisma/prisma/issues/2789#issuecomment-823078403
model Button {
  id        String                   @id @pg.Char(36) // nanoid
  latitude  Float                    @pg.DoublePrecision
  longitude Float                    @pg.DoublePrecision
  location  Unsupported("geometry")?

  // README: Do not change the database name, nether here, nor repository layer without caution.
  @@map("buttons")
}
